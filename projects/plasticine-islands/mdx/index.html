<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é›†æˆ MDX è§£æèƒ½åŠ› | Plasticine FE Diary</title>
    <meta name="description" content="A VitePress site">
    <link rel="preload stylesheet" href="/assets/style.2094949c.css" as="style">
    <link rel="modulepreload" href="/assets/app.f289581c.js">
    <link rel="modulepreload" href="/assets/projects_plasticine-islands_mdx_index.md.9490627d.lean.js">
    
    <link rel="icon" href="/logo.svg">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css">
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-6768d7c2><!--[--><!--]--><!--[--><span tabindex="-1" data-v-1fdb6e52></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-1fdb6e52> Skip to content </a><!--]--><!----><header class="VPNav" data-v-6768d7c2 data-v-a818a072><div class="VPNavBar has-sidebar" data-v-a818a072 data-v-600ebd8e><div class="container" data-v-600ebd8e><div class="VPNavBarTitle has-sidebar" data-v-600ebd8e data-v-52905a4e><a class="title" href="/" data-v-52905a4e><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.svg" alt data-v-3607f2f4><!--]--><!--[-->Plasticine FE Diary<!--]--><!--[--><!--]--></a></div><div class="content" data-v-600ebd8e><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-600ebd8e data-v-f58925e4><span id="main-nav-aria-label" class="visually-hidden" data-v-f58925e4>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" data-v-f58925e4 data-v-c91622e5 data-v-89ee9f61><!--[-->é¦–é¡µ<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f58925e4 data-v-00fbcf72><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00fbcf72><span class="text" data-v-00fbcf72><!----> æ¡†æ¶æºç å­¦ä¹  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-00fbcf72><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-00fbcf72><div class="VPMenu" data-v-00fbcf72 data-v-db4d460f><div class="items" data-v-db4d460f><!--[--><!--[--><div class="VPMenuLink" data-v-db4d460f data-v-1da1313f><a class="VPLink link" href="/framework-source-learning/01-jsx/" data-v-1da1313f data-v-89ee9f61><!--[-->React<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/micro-frontend/what-problem-solve/" data-v-f58925e4 data-v-c91622e5 data-v-89ee9f61><!--[-->å¾®å‰ç«¯<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-f58925e4 data-v-00fbcf72><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00fbcf72><span class="text" data-v-00fbcf72><!----> é¡¹ç›® <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-00fbcf72><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-00fbcf72><div class="VPMenu" data-v-00fbcf72 data-v-db4d460f><div class="items" data-v-db4d460f><!--[--><!--[--><div class="VPMenuLink" data-v-db4d460f data-v-1da1313f><a class="VPLink link" href="/projects/plasticine-islands/introduction/" data-v-1da1313f data-v-89ee9f61><!--[-->åŸºäº Islands æ¶æ„çš„ SSG æ¡†æ¶<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f58925e4 data-v-00fbcf72><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00fbcf72><span class="text" data-v-00fbcf72><!----> TypeScript <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-00fbcf72><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-00fbcf72><div class="VPMenu" data-v-00fbcf72 data-v-db4d460f><div class="items" data-v-db4d460f><!--[--><!--[--><div class="VPMenuLink" data-v-db4d460f data-v-1da1313f><a class="VPLink link" href="/typescript/type-challenges/summary.html" data-v-1da1313f data-v-89ee9f61><!--[-->TypeScript ç±»å‹æŒ‘æˆ˜<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f58925e4 data-v-00fbcf72><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00fbcf72><span class="text" data-v-00fbcf72><!----> åç«¯ <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-00fbcf72><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-00fbcf72><div class="VPMenu" data-v-00fbcf72 data-v-db4d460f><div class="items" data-v-db4d460f><!--[--><!--[--><div class="VPMenuLink" data-v-db4d460f data-v-1da1313f><a class="VPLink link" href="/backend/nest/basic/" data-v-1da1313f data-v-89ee9f61><!--[-->NestJS<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f58925e4 data-v-00fbcf72><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00fbcf72><span class="text" data-v-00fbcf72><!----> ç®—æ³• <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-00fbcf72><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-00fbcf72><div class="VPMenu" data-v-00fbcf72 data-v-db4d460f><div class="items" data-v-db4d460f><!--[--><!--[--><div class="VPMenuLink" data-v-db4d460f data-v-1da1313f><a class="VPLink link" href="/algorithm/array/binary-search/" data-v-1da1313f data-v-89ee9f61><!--[-->æ•°ç»„<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-db4d460f data-v-1da1313f><a class="VPLink link" href="/algorithm/linked-list/flip-linked-list/" data-v-1da1313f data-v-89ee9f61><!--[-->é“¾è¡¨<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-db4d460f data-v-1da1313f><a class="VPLink link" href="/algorithm/binary-tree/bfs/" data-v-1da1313f data-v-89ee9f61><!--[-->äºŒå‰æ ‘<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/linux/" data-v-f58925e4 data-v-c91622e5 data-v-89ee9f61><!--[-->Linux<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/git/" data-v-f58925e4 data-v-c91622e5 data-v-89ee9f61><!--[-->Git<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-600ebd8e data-v-1610ea23><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-1610ea23 data-v-f094a955 data-v-f0a7d495><span class="check" data-v-f0a7d495><span class="icon" data-v-f0a7d495><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-f094a955><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-f094a955><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-600ebd8e data-v-82dbe787 data-v-eff5b296><!--[--><a class="VPSocialLink" href="https://github.com/Plasticine-Yang/Plasticine-Yang.github.io" target="_blank" rel="noopener" data-v-eff5b296 data-v-62be7a22><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-600ebd8e data-v-6a8420c1 data-v-00fbcf72><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-00fbcf72><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-00fbcf72><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-00fbcf72><div class="VPMenu" data-v-00fbcf72 data-v-db4d460f><!----><!--[--><!--[--><!----><div class="group" data-v-6a8420c1><div class="item appearance" data-v-6a8420c1><p class="label" data-v-6a8420c1>Appearance</p><div class="appearance-action" data-v-6a8420c1><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-6a8420c1 data-v-f094a955 data-v-f0a7d495><span class="check" data-v-f0a7d495><span class="icon" data-v-f0a7d495><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-f094a955><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-f094a955><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-6a8420c1><div class="item social-links" data-v-6a8420c1><div class="VPSocialLinks social-links-list" data-v-6a8420c1 data-v-eff5b296><!--[--><a class="VPSocialLink" href="https://github.com/Plasticine-Yang/Plasticine-Yang.github.io" target="_blank" rel="noopener" data-v-eff5b296 data-v-62be7a22><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-600ebd8e data-v-a05f2df1><span class="container" data-v-a05f2df1><span class="top" data-v-a05f2df1></span><span class="middle" data-v-a05f2df1></span><span class="bottom" data-v-a05f2df1></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-6768d7c2 data-v-866a112c><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-866a112c><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-866a112c><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-866a112c>Menu</span></button><a class="top-link" href="#" data-v-866a112c> Return to top </a></div><aside class="VPSidebar" data-v-6768d7c2 data-v-97675046><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-97675046><span class="visually-hidden" id="sidebar-aria-label" data-v-97675046> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-97675046><section class="VPSidebarGroup" data-v-97675046 data-v-29846e0c><div class="title" data-v-29846e0c><h2 class="title-text" data-v-29846e0c>åŸºäº Islands æ¶æ„çš„ SSG æ¡†æ¶</h2><div class="action" data-v-29846e0c><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-29846e0c><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-29846e0c><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-29846e0c><!--[--><!--[--><a class="VPLink link link" href="/projects/plasticine-islands/introduction/" style="padding-left:0px;" tabindex="-1" data-v-29c895fd data-v-89ee9f61><!--[--><span class="link-text" data-v-29c895fd>ä»‹ç»</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/projects/plasticine-islands/mvp/" style="padding-left:0px;" tabindex="-1" data-v-29c895fd data-v-89ee9f61><!--[--><span class="link-text" data-v-29c895fd>MVP ç‰ˆæœ¬å¼€å‘</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/projects/plasticine-islands/config-resolver/" style="padding-left:0px;" tabindex="-1" data-v-29c895fd data-v-89ee9f61><!--[--><span class="link-text" data-v-29c895fd>é…ç½®æ–‡ä»¶è§£æåŠŸèƒ½</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/projects/plasticine-islands/conventional-based-routing/" style="padding-left:0px;" tabindex="-1" data-v-29c895fd data-v-89ee9f61><!--[--><span class="link-text" data-v-29c895fd>çº¦å®šå¼è·¯ç”±</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/projects/plasticine-islands/mdx/" style="padding-left:0px;" tabindex="-1" data-v-29c895fd data-v-89ee9f61><!--[--><span class="link-text" data-v-29c895fd>é›†æˆ MDX è§£æèƒ½åŠ›</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/projects/plasticine-islands/mdx-hmr/" style="padding-left:0px;" tabindex="-1" data-v-29c895fd data-v-89ee9f61><!--[--><span class="link-text" data-v-29c895fd>å¼€å‘é˜¶æ®µ MDX æ¨¡å—çƒ­æ›´æ–°</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-6768d7c2 data-v-8f239b2b><div class="VPDoc has-sidebar has-aside" data-v-8f239b2b data-v-801fa70d><div class="container" data-v-801fa70d><div class="aside" data-v-801fa70d><div class="aside-curtain" data-v-801fa70d></div><div class="aside-container" data-v-801fa70d><div class="aside-content" data-v-801fa70d><div class="VPDocAside" data-v-801fa70d data-v-633b98e9><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-633b98e9 data-v-e428615b><div class="content" data-v-e428615b><div class="outline-marker" data-v-e428615b></div><div class="outline-title" data-v-e428615b>ç›®å½•</div><nav aria-labelledby="doc-outline-aria-label" data-v-e428615b><span class="visually-hidden" id="doc-outline-aria-label" data-v-e428615b> Table of Contents for current page </span><ul class="root" data-v-e428615b data-v-81026c66><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-633b98e9></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-801fa70d><div class="content-container" data-v-801fa70d><!--[--><!--]--><main class="main" data-v-801fa70d><div style="position:relative;" class="vp-doc _projects_plasticine-islands_mdx_index" data-v-801fa70d><div><h1 id="é›†æˆ-mdx-è§£æèƒ½åŠ›" tabindex="-1">é›†æˆ MDX è§£æèƒ½åŠ› <a class="header-anchor" href="#é›†æˆ-mdx-è§£æèƒ½åŠ›" aria-hidden="true">#</a></h1><div class="tip custom-block"><p class="custom-block-title">æœ¬èŠ‚ä»£ç åˆ†æ”¯åœ°å€</p><p><a href="https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx" target="_blank" rel="noreferrer">https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx</a></p></div><h2 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a></h2><p>é¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹ä¸€äº›å‰ç½®çŸ¥è¯†ï¼š</p><ul><li><p>remark: remark æ˜¯ä¸€ä¸ª Markdown å¤„ç†å™¨ï¼Œå®ƒå¯ä»¥å°† Markdown æ ¼å¼çš„æ–‡æœ¬å†…å®¹è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œç„¶åé€šè¿‡æ’ä»¶ç³»ç»Ÿå¯¹ AST è¿›è¡Œä¿®æ”¹æˆ–æ“ä½œï¼Œæœ€ç»ˆè¾“å‡ºç¬¦åˆç”¨æˆ·éœ€æ±‚çš„æ ¼å¼ã€‚é€šè¿‡ remarkï¼Œå¯ä»¥å¯¹ Markdown æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®ã€ä»£ç å—è½¬æ¢ã€è¡¨æ ¼è½¬æ¢ã€é“¾æ¥å¤„ç†ç­‰æ“ä½œã€‚</p></li><li><p>rehype: rehype æ˜¯ä¸€ä¸ª HTML å¤„ç†å™¨ï¼Œå®ƒå¯ä»¥å°† HTML æ ¼å¼çš„æ–‡æœ¬å†…å®¹è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œç„¶åé€šè¿‡æ’ä»¶ç³»ç»Ÿå¯¹ AST è¿›è¡Œä¿®æ”¹æˆ–æ“ä½œï¼Œæœ€ç»ˆè¾“å‡ºç¬¦åˆç”¨æˆ·éœ€æ±‚çš„æ ¼å¼ã€‚é€šè¿‡ rehypeï¼Œå¯ä»¥å¯¹ HTML æ–‡ä»¶è¿›è¡Œè¯­è¨€è½¬æ¢ã€å…ƒç´ è½¬æ¢ã€å±æ€§è½¬æ¢ã€æ ‡å‡†åŒ–å¤„ç†ç­‰æ“ä½œã€‚</p></li></ul><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œremark ä¸ rehype ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥å®ç° Markdown åˆ° HTML çš„å®Œæ•´è½¬æ¢è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ remark å°† Markdown æ–‡ä»¶è½¬æ¢ä¸º HTMLï¼Œç„¶åä½¿ç”¨ rehype å¯¹ HTML è¿›è¡Œè¿›ä¸€æ­¥çš„ä¿®æ”¹å’Œå¤„ç†ï¼Œä¾‹å¦‚æ·»åŠ æ ·å¼ã€JavaScriptã€SEO ä¼˜åŒ–ç­‰æ“ä½œã€‚</p><p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ remark å¤„ç† markdownï¼Œé›†æˆå„ç§å¤„ç† markdown çš„ remark æ’ä»¶ï¼Œç”Ÿæˆ AST åè½¬æˆ htmlï¼Œå†ä¸¢ç»™ rehype å»å¤„ç†å¦‚æ ·å¼ç­‰åŠŸèƒ½</p><p>ä¸ºäº†æ›´åŠ æ–¹ä¾¿åœ°å®Œæˆè¿™ä»¶äº‹æƒ…ï¼Œåˆå¼•å‡ºäº†ä¸€ä¸ª <code>remark-rehype</code> åº“</p><p>remark-rehype æ˜¯ä¸€ä¸ªåŸºäº remark å’Œ rehype çš„è½¬æ¢å™¨ï¼Œå¯ä»¥å°† Markdown æ ¼å¼çš„æ–‡æœ¬å†…å®¹è½¬æ¢ä¸º HTML æ ¼å¼çš„æ–‡æœ¬å†…å®¹ã€‚å®ƒçš„ä½œç”¨æ˜¯å°† remark ç”Ÿæˆçš„ Markdown æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰è½¬æ¢ä¸º rehype å¯ä»¥å¤„ç†çš„ HTML ASTï¼Œä»è€Œç”Ÿæˆæœ€ç»ˆçš„ HTML è¾“å‡ºã€‚</p><p>remark-rehype çš„ä½œç”¨ç±»ä¼¼äºä¸€ä¸ªæ¡¥æ¢ï¼Œå®ƒå°† remark å’Œ rehype è¿æ¥èµ·æ¥ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨ remark ä¸­ä½¿ç”¨ Markdown è¯­æ³•ï¼Œç„¶åé€šè¿‡ remark-rehype å°†å…¶è½¬æ¢ä¸º rehype å¯ä»¥å¤„ç†çš„ HTML è¯­æ³•ï¼Œæœ€ç»ˆç”Ÿæˆç¬¦åˆç”¨æˆ·éœ€æ±‚çš„ HTML è¾“å‡ºã€‚</p><p>remark-rehype é€šè¿‡æ’ä»¶çš„å½¢å¼æ¥æ‰©å±•å…¶åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ ä¸åŒçš„æ’ä»¶æ¥å®ç°ä¸åŒçš„è½¬æ¢æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ remark-gfm æ’ä»¶æ¥æ”¯æŒ GitHub Flavored Markdown çš„è¯­æ³•ï¼Œç„¶åä½¿ç”¨ rehype-highlight æ’ä»¶æ¥å¯¹ä»£ç å—è¿›è¡Œè¯­æ³•é«˜äº®ï¼Œä»è€Œå®ç°æ›´å¥½çš„ Markdown åˆ° HTML çš„è½¬æ¢æ•ˆæœã€‚</p><h2 id="é›†æˆæ€è·¯-å¾…é›†æˆçš„åŠŸèƒ½" tabindex="-1">é›†æˆæ€è·¯ &amp; å¾…é›†æˆçš„åŠŸèƒ½ <a class="header-anchor" href="#é›†æˆæ€è·¯-å¾…é›†æˆçš„åŠŸèƒ½" aria-hidden="true">#</a></h2><p>å¯ä»¥é€šè¿‡ vite æ’ä»¶çš„æ–¹å¼é›†æˆ mdx çš„è§£æèƒ½åŠ›ï¼Œ<a href="https://mdxjs.com/packages/rollup/" target="_blank" rel="noreferrer">@mdx-js/rollup</a> è¿™ä¸€ rollup æ’ä»¶å°±æä¾›äº†è¿™æ ·çš„èƒ½åŠ›ï¼Œå¥½åœ¨ vite å¯¹ rollup æ’ä»¶çš„å…¼å®¹æ€§å¾ˆå¥½ï¼Œå¯ä»¥æ— ç¼ä½¿ç”¨</p><p><code>@mdx-js/rollup</code> ä¸­æ”¯æŒå•ç‹¬é…ç½® remark å’Œ rehype æ’ä»¶ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªåŒ…æ¥ç»´æŠ¤ mdx ç›¸å…³çš„å„ç§æ’ä»¶é›†æˆ</p><p>é›†æˆçš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li><p><a href="https://github.github.com/gfm/" target="_blank" rel="noreferrer">gfm</a>ï¼šGithub Flavored Markdownï¼Œæ˜¯ä¸€ç§ markdown è§„èŒƒ</p></li><li><p>é”šç‚¹è·³è½¬ï¼šå¯¹äº markdown ä¸­çš„ <code>#</code>ã€<code>##</code> ç­‰æ ‡é¢˜ï¼Œå¤„ç†æˆ html åä¼šè‡ªåŠ¨åŠ ä¸Šé”šç‚¹ï¼Œæ–¹ä¾¿ç‚¹å‡»è¿›è¡Œè·³è½¬</p></li><li><p>ä»£ç å—å±•ç¤ºè¯­è¨€ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼Œèƒ½åœ¨å³ä¾§çœ‹åˆ°ä»£ç å—çš„è¯­è¨€</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello world</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></li><li><p>ä»£ç å—è¯­æ³•é«˜äº®</p></li></ul><h2 id="vite-æ’ä»¶-mdx" tabindex="-1">Vite æ’ä»¶ - mdx <a class="header-anchor" href="#vite-æ’ä»¶-mdx" aria-hidden="true">#</a></h2><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„åŒ… - <code>vite-plugin-mdx</code></p><p>åœ¨å…¥å£æ–‡ä»¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼Œå¹¶é›†æˆåˆ° core åŒ…ä¸­ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-VqisZ" id="tab-em08spF" checked="checked"><label for="tab-em08spF">packages/vite-plugin-mdx/src/index.ts</label><input type="radio" name="group-VqisZ" id="tab-A5AFjXp"><label for="tab-A5AFjXp">packages/core/src/helpers/resolve-vite-plugins.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rollupPluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@mdx-js/rollup</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginReact </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@vitejs/plugin-react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">PluginOption</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ResolvedConfig</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">VitePluginPlasticineIslandsSiteConfigOptions</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/types</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginPlasticineIslandsConventionalBasedRouting </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-conventional-based-routing</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginDevServerHtml </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-dev-server-html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line highlighted"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-mdx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginPlasticineIslandsSiteConfig </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-plasticine-islands-site-config</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">BUNDLESS_PATH</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">CLIENT_ENTRY_PATH</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">DEV_SERVER_HTML_PATH</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../constants</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ResolveVitePluginsOptions</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">resolvedConfig</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ResolvedConfig</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">onDevServerRestart</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">VitePluginPlasticineIslandsSiteConfigOptions</span><span style="color:#A6ACCD;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">onDevServerRestart</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">resolveVitePlugins</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">options</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ResolveVitePluginsOptions</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginOption</span><span style="color:#A6ACCD;">[] </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">resolvedConfig</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">onDevServerRestart</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">options</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">resolvedConfig</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// react</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginReact</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// dev server</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginDevServerHtml</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      htmlPath</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">DEV_SERVER_HTML_PATH</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      clintEntryPath</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">CLIENT_ENTRY_PATH</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      loadDefaultHtmlOnError</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      filesToWatch</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#A6ACCD;">BUNDLESS_PATH</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// é€šè¿‡è™šæ‹Ÿæ¨¡å—è®©å‰ç«¯åº”ç”¨ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ SiteConfig æ•°æ®</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginPlasticineIslandsSiteConfig</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">resolvedConfig</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">onDevServerRestart</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// çº¦å®šå¼è·¯ç”±</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginPlasticineIslandsConventionalBasedRouting</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// mdx</span></span>
<span class="line highlighted"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>ç„¶åæ¥ playground ä¸­éªŒè¯ä¸€ä¸‹ï¼Œæ–°å»º <code>docs/test.md</code></p><p>å¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><div class="language-md"><button title="Copy Code" class="copy"></button><span class="lang">md</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;"># </span><span style="color:#FFCB6B;">Test markdown</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">## </span><span style="color:#FFCB6B;">Hello</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> foo</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> bar</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> baz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">1.</span><span style="color:#A6ACCD;"> hi</span></span>
<span class="line"><span style="color:#89DDFF;">2.</span><span style="color:#A6ACCD;"> hello</span></span>
<span class="line"><span style="color:#89DDFF;">3.</span><span style="color:#A6ACCD;"> how are u</span></span>
<span class="line"></span></code></pre></div><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/assets/mdåˆæ­¥æ–‡ä»¶è§£ææ•ˆæœ.748384c5.png" alt="mdåˆæ­¥æ–‡ä»¶è§£ææ•ˆæœ" data-fancybox="gallery"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»èƒ½å¤ŸæˆåŠŸè§£æ md æ–‡ä»¶äº†ï¼Œæ¥ä¸‹æ¥å°±ä¸€æ­¥æ­¥é›†æˆå„ç§å®ç”¨çš„ remark å’Œ rehype æ’ä»¶å§</p><h3 id="gfm" tabindex="-1">gfm <a class="header-anchor" href="#gfm" aria-hidden="true">#</a></h3><p>gfm æ˜¯ä¸€ä¸ª markdown è§„èŒƒï¼Œæ‰€ä»¥ç†æ‰€å½“ç„¶æ˜¯å±äº remark çš„ç®¡è¾–èŒƒç•´ï¼Œå› æ­¤éœ€è¦å…ˆå®‰è£…è¯¥ remark æ’ä»¶</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages/vite-plugin-mdx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remark-gfm</span></span>
<span class="line"></span></code></pre></div><p>ç„¶åé›†æˆåˆ° remark ä¸­</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-ZOjDj" id="tab-oSrDWwU" checked="checked"><label for="tab-oSrDWwU">packages/vite-plugin-mdx/src/index.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rollupPluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@mdx-js/rollup</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkPluginGFM </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-gfm</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#A6ACCD;">remarkPluginGFM</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>æ¥ä¸‹æ¥ä¿®æ”¹ playground ä¸­åˆšåˆšæ–°å»ºçš„ <code>test.md</code>ï¼Œè¾“å…¥ä¸€äº›é“¾æ¥ï¼Œæ ¹æ® gfm çš„è§„èŒƒï¼Œä¼šè‡ªåŠ¨å°†é“¾æ¥è§£ææˆ a æ ‡ç­¾</p><div class="language-md"><button title="Copy Code" class="copy"></button><span class="lang">md</span><pre class="shiki material-palenight has-diff"><code><span class="line"><span style="color:#89DDFF;"># </span><span style="color:#FFCB6B;">Test markdown</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">## </span><span style="color:#FFCB6B;">Hello</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> foo</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> bar</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> baz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">1.</span><span style="color:#A6ACCD;"> hi</span></span>
<span class="line"><span style="color:#89DDFF;">2.</span><span style="color:#A6ACCD;"> hello</span></span>
<span class="line"><span style="color:#89DDFF;">3.</span><span style="color:#A6ACCD;"> how are u</span></span>
<span class="line"></span>
<span class="line diff add"><span style="color:#A6ACCD;">literals www.example.com, https://example.com and contact@example.com </span></span>
<span class="line"></span></code></pre></div><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/assets/é›†æˆremark-gfmçš„æ•ˆæœ.8450bc6f.png" alt="é›†æˆremark-gfmçš„æ•ˆæœ" data-fancybox="gallery"></p><h3 id="é”šç‚¹è·³è½¬" tabindex="-1">é”šç‚¹è·³è½¬ <a class="header-anchor" href="#é”šç‚¹è·³è½¬" aria-hidden="true">#</a></h3><p>è¿™ä¸ªåŠŸèƒ½æ¶‰åŠåˆ°çš„éƒ½æ˜¯å¯¹ html çš„å¤„ç†ï¼Œå› æ­¤å’Œ rehype æœ‰å…³ï¼Œé€šè¿‡åœ¨ github ä¸Šæœç´¢ç›¸å…³æ’ä»¶ï¼Œå¯ä»¥æ‰¾åˆ°ä¸‹é¢ä¸¤ä¸ªæ’ä»¶æ­é…ä½¿ç”¨å¯ä»¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š</p><ul><li><a href="https://github.com/rehypejs/rehype-autolink-headings" target="_blank" rel="noreferrer">rehype-autolink-headings</a>ï¼šç”¨äºä¸ºå¸¦æœ‰ id çš„ <code>h1, h2</code> ç­‰ headings æ ‡ç­¾æ·»åŠ  a æ ‡ç­¾é“¾æ¥ï¼Œå¹¶ä¸” href ä¼šæŒ‡å‘å¯¹åº”çš„ heading æ ‡ç­¾ä¸Šçš„ id</li></ul><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å‰ --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">some-id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">some-id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">aria-hidden</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">tabindex</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#some-id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">icon icon-link</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>é—®é¢˜æ˜¯ç»è¿‡ remark å¤„ç†å¾—åˆ°çš„ ast è¢« rehype è½¬æˆçš„ html ä¸­ï¼Œheadings æ ‡ç­¾æ˜¯æ²¡æœ‰ id å±æ€§çš„ï¼Œå› è€Œæ— æ³•ç”Ÿæˆé”šç‚¹é“¾æ¥ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>è¿™æ—¶å€™å°±éœ€è¦å¦ä¸€ä¸ªæ’ä»¶äº†</p><ul><li><a href="https://github.com/rehypejs/rehype-slug" target="_blank" rel="noreferrer">rehype-slug</a>ï¼šç”¨äºä¸º headings æ ‡ç­¾æ·»åŠ  id å±æ€§</li></ul><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å‰ --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> bar </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lorem-ipsum</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo-</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-------bar---</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> bar </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>ç”Ÿæˆçš„ id ä¼šæ ¹æ®æ ‡ç­¾çš„å†…å®¹æ¥å†³å®š</p><p>è¿™ä¸¤ä¸ªæ’ä»¶æ­é…èµ·æ¥å°±èƒ½å¤Ÿå®ç°é”šç‚¹é“¾æ¥å•¦ï¼</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-r-Ke6" id="tab-pfAuGKs" checked="checked"><label for="tab-pfAuGKs">packages/vite-plugin-mdx/src/index.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rollupPluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@mdx-js/rollup</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeAutolinkHeadings</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Options</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">RehypeAutolinkHeadingsOptions</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-autolink-headings</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeSlug </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-slug</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkGfm </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-gfm</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// Github Flavored Markdown Spec: https://github.github.com/gfm/</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">remarkGfm</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸º h1, h2 ç­‰ headings æ ‡ç­¾ç”Ÿæˆ idï¼Œid çš„å€¼ä¼šæ ¹æ®æ ‡ç­¾çš„å†…å®¹å†³å®š</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">rehypeSlug</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸ºå¸¦æœ‰ id å±æ€§çš„ headings æ ‡ç­¾æ·»åŠ é”šç‚¹é“¾æ¥</span></span>
<span class="line"><span style="color:#F07178;">      [</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">rehypeAutolinkHeadings</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¸º headings æ ‡ç­¾æ³¨å…¥é¢å¤–çš„ class - ç”¨äºå®šåˆ¶æ ·å¼</span></span>
<span class="line"><span style="color:#F07178;">          properties</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            class</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">header-anchor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">          content</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            value</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RehypeAutolinkHeadingsOptions</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><h3 id="ä»£ç å—å±•ç¤ºè¯­è¨€" tabindex="-1">ä»£ç å—å±•ç¤ºè¯­è¨€ <a class="header-anchor" href="#ä»£ç å—å±•ç¤ºè¯­è¨€" aria-hidden="true">#</a></h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç›®å‰ä½¿ç”¨ä»£ç å—çš„è¯ä¼šè¢«è½¬æˆä»€ä¹ˆæ ·çš„ html</p><p><img src="/assets/é»˜è®¤æƒ…å†µä¸‹markdownä»£ç å—è¢«è½¬æ¢çš„html.4b9b9936.png" alt="é»˜è®¤æƒ…å†µä¸‹markdownä»£ç å—è¢«è½¬æ¢çš„html" data-fancybox="gallery"></p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">language-ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>è¿™ç§ç»“æ„çš„ html å¹¶ä¸èƒ½å±•ç¤ºä»£ç å—çš„è¯­è¨€ï¼Œåº”å½“è½¬æˆå¦‚ä¸‹ç»“æ„æ‰è¡Œï¼š</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">language-ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lang</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">js</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">language-ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>è¿™æ ·æ‰æ–¹ä¾¿æˆ‘ä»¬åç»­å»å®ç°æ ·å¼çš„æ—¶å€™è¿›è¡Œå¸ƒå±€ï¼Œé‚£ä¹ˆè¦å¦‚ä½•å®Œæˆè¿™ä¸ªè½¬æ¢å‘¢ï¼Ÿ</p><p>ç”±äºè¿™æ˜¯ä¸€ä¸ªå¯¹ html çš„æ“ä½œï¼Œå› æ­¤é€‚åˆé€šè¿‡ rehype æ’ä»¶å»æ‹¦æˆªè¿›è¡Œè½¬æ¢</p><h4 id="rehype-æ’ä»¶è½¬æ¢ä»£ç å—ç”Ÿæˆçš„-html-ç»“æ„" tabindex="-1">rehype æ’ä»¶è½¬æ¢ä»£ç å—ç”Ÿæˆçš„ html ç»“æ„ <a class="header-anchor" href="#rehype-æ’ä»¶è½¬æ¢ä»£ç å—ç”Ÿæˆçš„-html-ç»“æ„" aria-hidden="true">#</a></h4><p>å¦‚ä½•å¼€å‘ rehype æ’ä»¶å‘¢ï¼Ÿå¯ä»¥åˆ°å…¶ <a href="https://github.com/rehypejs/rehype" target="_blank" rel="noreferrer">å®˜æ–¹æ–‡æ¡£</a> ä¸­æŸ¥çœ‹</p><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä¸‹é¢å‡ ä¸ªåŒ…</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages/vite-plugin-mdx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">unified</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">unist-util-visit</span></span>
<span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages/vite-plugin-mdx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@types/hast</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-D</span></span>
<span class="line"></span></code></pre></div><ul><li>unified ç”¨äºæä¾›æ’ä»¶çš„ç±»å‹å®šä¹‰</li><li>unist-util-visit ç”¨äºéå† ast</li><li>@types/hast åˆ™ç”¨äºæä¾› rehype çš„ ast èŠ‚ç‚¹çš„ç±»å‹å®šä¹‰</li></ul><p>æˆ‘ä»¬å¯ä»¥å…ˆç¼–å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•ï¼Œçœ‹çœ‹ç›®å‰éå† rehype çš„ ast æ—¶æ˜¯å•¥æ ·çš„</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-gWqyz" id="tab-AHuM7yw" checked="checked"><label for="tab-AHuM7yw">packages/vite-plugin-mdx/src/__test__/rehype-pre-wrapper.test.ts</label><input type="radio" name="group-gWqyz" id="tab-Im-R5Ju"><label for="tab-Im-R5Ju">packages/vite-plugin-mdx/src/plugins/rehype-pre-wrapper.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">unified</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkParse </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-parse</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkRehype </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-rehype</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeFormat </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-format</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeStringify </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-stringify</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../plugins</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypePreWrapper</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">happy path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">unified</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkParse</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkRehype</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeFormat</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeStringify</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#A6ACCD;">\`\`\`</span><span style="color:#C3E88D;">ts</span></span>
<span class="line"><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">\`\`\`</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">processSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;pre&gt;&lt;code class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;language-ts</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;/code&gt;&lt;/pre&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">visit</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unist-util-visit</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ä¸º markdown ä»£ç å—è½¬æ¢æˆçš„ html ä¸­çš„ pre æ ‡ç­¾è¿›è¡Œä¿®æ”¹</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">example</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * before:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * after:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;div class=&quot;language-ts&quot;&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;span class=&quot;lang&quot;&gt;js&lt;/span&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *     &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/div&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rehypePreWrapper</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Root</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">tree</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">visit</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">tree</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 1. æ‰¾åˆ° pre å…ƒç´ èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 2. è§£æå‡ºä»£ç å—çš„è¯­è¨€ç±»å‹</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 3. ä¿®æ”¹ pre å…ƒç´ èŠ‚ç‚¹çš„ç»“æ„</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><p><img src="/assets/é»˜è®¤æƒ…å†µä¸‹éå†ä»£ç å—å¯¹åº”çš„htmlçš„ast.937087f3.png" alt="é»˜è®¤æƒ…å†µä¸‹éå†ä»£ç å—å¯¹åº”çš„htmlçš„ast" data-fancybox="gallery"></p><p>æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è¦æ‰¾åˆ° type ä¸º <code>element</code> ä¸” <code>tagName</code> ä¸º <code>pre</code>ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ type ä¸º <code>element</code>ï¼Œ<code>tagName</code> ä¸º <code>code</code>ï¼Œç„¶åå¯¹å…¶è¿›è¡Œä¿®æ”¹å³å¯</p><p>å¦‚ä½•éå†æ‰€æœ‰çš„ type ä¸º <code>element</code> çš„èŠ‚ç‚¹å‘¢ï¼Ÿ<code>visit</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å°±å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">visit</span><span style="color:#A6ACCD;">(tree</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><img src="/assets/éå†æ‰€æœ‰typeä¸ºelementçš„èŠ‚ç‚¹.891b68d8.png" alt="éå†æ‰€æœ‰typeä¸ºelementçš„èŠ‚ç‚¹" data-fancybox="gallery"></p><p>æœ€ç»ˆå¯ä»¥å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Element</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">visit</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unist-util-visit</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ä¸º markdown ä»£ç å—è½¬æ¢æˆçš„ html ä¸­çš„ pre æ ‡ç­¾è¿›è¡Œä¿®æ”¹</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">example</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * before:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * after:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;div class=&quot;language-ts&quot;&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;span class=&quot;lang&quot;&gt;js&lt;/span&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *     &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/div&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rehypePreWrapper</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Root</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">tree</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">visit</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">tree</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 1. æ‰¾åˆ° pre å…ƒç´ èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">visited</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 2. è§£æå‡ºä»£ç å—çš„è¯­è¨€ç±»å‹</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">className</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">toString</span><span style="color:#F07178;">() </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">-</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 3. ä¿®æ”¹ pre å…ƒç´ èŠ‚ç‚¹çš„ç»“æ„ - å…ˆæ‹·è´ä¸€ä¸ª node å‡ºæ¥ï¼Œå†å¯¹ node è¿›è¡Œä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">clonedNode</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          tagName</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pre</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          children</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// é¿å…é‡å¤éå†ç›¸åŒçš„ pre å…ƒç´ èŠ‚ç‚¹å¯¼è‡´é€’å½’æ— æ³•ç»ˆæ­¢</span></span>
<span class="line"><span style="color:#F07178;">            visited</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">div</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">className</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            tagName</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">span</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            properties</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">              className</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lang</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">            children</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#F07178;">                  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">                    type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">                    value</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">                  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">                ]</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#A6ACCD;">clonedNode</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        ]</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/** </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">description</span><span style="color:#676E95;font-style:italic;"> åˆ¤æ–­å…ƒç´ èŠ‚ç‚¹æ˜¯å¦æ˜¯ markdown ä»£ç å—è½¬æ¢è€Œæ¥çš„ html ast èŠ‚ç‚¹ */</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">element</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pre</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">code</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypePreWrapper</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">should wrap the `pre` element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">unified</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkParse</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkRehype</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeFormat</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeStringify</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#A6ACCD;">\`\`\`</span><span style="color:#C3E88D;">ts</span></span>
<span class="line"><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">\`\`\`</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">processSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">      &lt;div class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;language-ts</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;lang</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;ts&lt;/span&gt;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">        &lt;pre&gt;&lt;code class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;language-ts</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;&lt;/pre&gt;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">      &lt;/div&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>æœ€ç»ˆåº”ç”¨åˆ°æ¡†æ¶ä¸­çš„æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/assets/preWrapperæ’ä»¶çš„æœ€ç»ˆæ•ˆæœ.be13395b.png" alt="preWrapperæ’ä»¶çš„æœ€ç»ˆæ•ˆæœ" data-fancybox="gallery"></p><h3 id="ä»£ç å—è¯­æ³•é«˜äº®" tabindex="-1">ä»£ç å—è¯­æ³•é«˜äº® <a class="header-anchor" href="#ä»£ç å—è¯­æ³•é«˜äº®" aria-hidden="true">#</a></h3><p>ç›®å‰çš„ä»£ç å—æ¸²æŸ“æ•ˆæœæ˜¯ä¸Šå›¾é‚£æ ·çš„ï¼Œå¹¶æ²¡æœ‰è¯­æ³•é«˜äº®ï¼Œçœ‹èµ·æ¥å¾ˆä¸ç¾è§‚ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±é€šè¿‡ <a href="https://github.com/shikijs/shiki" target="_blank" rel="noreferrer">shiki</a> æ¥å®ç°ä»£ç å—è¯­æ³•é«˜äº®çš„æ•ˆæœ</p><h4 id="ä½“éªŒ-shiki" tabindex="-1">ä½“éªŒ shiki <a class="header-anchor" href="#ä½“éªŒ-shiki" aria-hidden="true">#</a></h4><p>å…ˆé€šè¿‡ä¸€ä¸ªå•æµ‹æ¥ç®€å•åœ°ä½“éªŒä¸€ä¸‹ shiki çš„åŠŸèƒ½</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-aCyJe" id="tab-OCESWhZ" checked="checked"><label for="tab-OCESWhZ">packages/vite-plugin-mdx/src/__test__/rehype-shiki.test.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> shiki </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypeShiki</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki demo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shiki</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHighlighter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      theme</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nord</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">codeToHtml</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> lang</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&quot;&lt;pre class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;shiki nord</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot; style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;background-color: #2e3440ff</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot; tabindex=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;0</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;code&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;console&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;.&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #88C0D0</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;log&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;(&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #A3BE8C</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;hello world&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div></div><h4 id="rehype-æ’ä»¶å®ç°ä»£ç å—è¯­æ³•é«˜äº®" tabindex="-1">rehype æ’ä»¶å®ç°ä»£ç å—è¯­æ³•é«˜äº® <a class="header-anchor" href="#rehype-æ’ä»¶å®ç°ä»£ç å—è¯­æ³•é«˜äº®" aria-hidden="true">#</a></h4><p>æˆ‘ä»¬å¯ä»¥å°† highlighter ä½œä¸ºå‚æ•°ï¼Œè¿™æ ·å°±èƒ½å°†ä»£ç é«˜äº®çš„è‡ªå®šä¹‰èƒ½åŠ›äº¤ç»™å¤–éƒ¨å†³å®šï¼Œæ’ä»¶å†…éƒ¨åªå…³æ³¨ highlighter çš„ä»£ç è½¬æ¢èƒ½åŠ›</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-R6_LN" id="tab-ZboTUAC" checked="checked"><label for="tab-ZboTUAC">packages/vite-plugin-mdx/src/plugins/rehype-shiki.ts</label><input type="radio" name="group-R6_LN" id="tab-w70sDsa"><label for="tab-w70sDsa">packages/vite-plugin-mdx/src/plugins/shared.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Element</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Highlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">visit</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unist-util-visit</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fromHtml</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast-util-from-html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">isCodeElement</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parseCodeElement</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./shared</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RehypeShikiOptions</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">shikiHighlighter</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Highlighter</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rehypeShiki</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">[</span><span style="color:#FFCB6B;">RehypeShikiOptions</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Root</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">options</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">options</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">tree</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">visit</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">tree</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">index</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">parent</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">index</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeContent</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">parseCodeElement</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">codeElement</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlightedCode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">codeToHtml</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">codeContent</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> lang</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// å°† shiki ç”Ÿæˆçš„ html è½¬æˆ hast æ›¿æ¢å½“å‰ node</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fragmentHast</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">fromHtml</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">highlightedCode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> fragment</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#A6ACCD;">parent</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">splice</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">index</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">fragmentHast</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Element</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Text</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/** </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">description</span><span style="color:#676E95;font-style:italic;"> åˆ¤æ–­å…ƒç´ èŠ‚ç‚¹æ˜¯å¦æ˜¯ markdown ä»£ç å—è½¬æ¢è€Œæ¥çš„ html ast èŠ‚ç‚¹ */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">element</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pre</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">code</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">description</span><span style="color:#676E95;font-style:italic;"> è§£æå‡ºä»£ç å— html å…ƒç´ çš„ classNameã€ä»£ç å†…å®¹ã€ä»£ç è¯­è¨€ç±»å‹</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">example</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ```</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">parseCodeElement</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">codeElement</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeContent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">codeElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Text</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">className</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">toString</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">-</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">codeContent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>æœ€åæ•ˆæœå¦‚ä¸‹ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-OxdYK" id="tab-rqRdpqY" checked="checked"><label for="tab-rqRdpqY">packages/vite-plugin-mdx/src/__test__/rehype-shiki.test.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeFormat </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-format</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeStringify </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-stringify</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkParse </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-parse</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkRehype </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-rehype</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> shiki </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">unified</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rehypeShiki</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../plugins</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypeShiki</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki demo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shiki</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHighlighter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      theme</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nord</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">codeToHtml</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> lang</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&quot;&lt;pre class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;shiki nord</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot; style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;background-color: #2e3440ff</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot; tabindex=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;0</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;code&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;console&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;.&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #88C0D0</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;log&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;(&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #A3BE8C</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;hello world&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">should highlight the code</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shiki</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHighlighter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      theme</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nord</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">unified</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkParse</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkRehype</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeShiki</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeFormat</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeStringify</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#A6ACCD;">\`\`\`</span><span style="color:#C3E88D;">ts</span></span>
<span class="line"><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">\`\`\`</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">processSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;pre class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;shiki nord</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot; style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;background-color: #2e3440ff</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot; tabindex=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;0</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;code&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;console&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;.&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #88C0D0</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;log&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;(&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #A3BE8C</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;hello world&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;)&lt;/span&gt;&lt;/span&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;span class=</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div></div><p>æœ€åæ•´åˆåˆ° Vite æ’ä»¶ä¸­å³å¯</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-R7OmZ" id="tab-24TrKw_" checked="checked"><label for="tab-24TrKw_">packages/vite-plugin-mdx/src/index.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// Github Flavored Markdown Spec: https://github.github.com/gfm/</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">remarkGfm</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸º h1, h2 ç­‰ headings æ ‡ç­¾ç”Ÿæˆ idï¼Œid çš„å€¼ä¼šæ ¹æ®æ ‡ç­¾çš„å†…å®¹å†³å®š</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">rehypeSlug</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸ºå¸¦æœ‰ id å±æ€§çš„ headings æ ‡ç­¾æ·»åŠ é”šç‚¹é“¾æ¥</span></span>
<span class="line"><span style="color:#F07178;">      [</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">rehypeAutolinkHeadings</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¸º headings æ ‡ç­¾æ³¨å…¥é¢å¤–çš„ class - ç”¨äºå®šåˆ¶æ ·å¼</span></span>
<span class="line"><span style="color:#F07178;">          properties</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            class</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">header-anchor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">          content</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            value</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RehypeAutolinkHeadingsOptions</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å°† markdown ä»£ç å—è½¬æ¢æˆçš„ html pre å…ƒç´ èŠ‚ç‚¹ wrap åˆ° div é‡Œï¼Œå¹¶å¸¦ä¸Šä»£ç å—å¯¹åº”çš„è¯­è¨€</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ä»£ç å—è¯­æ³•é«˜äº®</span></span>
<span class="line highlighted"><span style="color:#F07178;">      [</span></span>
<span class="line highlighted"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">rehypeShiki</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">          shikiHighlighter</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">getShikiHighlighter</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RehypeShikiOptions</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#F07178;">      ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹</p><p><img src="/assets/ä»£ç å—è¯­æ³•é«˜äº®æ’ä»¶æ•ˆæœ.c91178e6.png" alt="ä»£ç å—è¯­æ³•é«˜äº®æ’ä»¶æ•ˆæœ" data-fancybox="gallery"></p><div class="tip custom-block"><p class="custom-block-title">æœ¬èŠ‚ä»£ç åˆ†æ”¯åœ°å€</p><p><a href="https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx" target="_blank" rel="noreferrer">https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx</a></p></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-801fa70d data-v-6ee12f72><div class="edit-info" data-v-6ee12f72><!----><div class="last-updated" data-v-6ee12f72><p class="VPLastUpdated" data-v-6ee12f72 data-v-d26a8345>Last updated: <time datetime="2023-07-31T13:27:26.000Z" data-v-d26a8345></time></p></div></div><div class="prev-next" data-v-6ee12f72><div class="pager" data-v-6ee12f72><a class="pager-link prev" href="/projects/plasticine-islands/conventional-based-routing/" data-v-6ee12f72><span class="desc" data-v-6ee12f72>Previous page</span><span class="title" data-v-6ee12f72>çº¦å®šå¼è·¯ç”±</span></a></div><div class="has-prev pager" data-v-6ee12f72><a class="pager-link next" href="/projects/plasticine-islands/mdx-hmr/" data-v-6ee12f72><span class="desc" data-v-6ee12f72>Next page</span><span class="title" data-v-6ee12f72>å¼€å‘é˜¶æ®µ MDX æ¨¡å—çƒ­æ›´æ–°</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-6768d7c2 data-v-13fe916b><div class="container" data-v-13fe916b><p class="message" data-v-13fe916b>Released under the MIT License.</p><p class="copyright" data-v-13fe916b>Copyright Â© 2023-present Plasticine-Yang</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"projects_plasticine-islands_mdx-hmr_index.md\":\"8ac67efe\",\"typescript_type-challenges_hard.md\":\"e90d7992\",\"typescript_type-challenges_medium.md\":\"272016de\",\"typescript_type-challenges_summary.md\":\"5f844897\",\"typescript_type-challenges_easy.md\":\"f314dcaa\",\"algorithm_array_binary-search_index.md\":\"fa9b4d7b\",\"projects_plasticine-islands_mvp_index.md\":\"beee4ac1\",\"algorithm_array_oppsite-direction-double-pointer_index.md\":\"34affcf1\",\"algorithm_array_same-direction-double-pointer_index.md\":\"3675e70d\",\"algorithm_binary-tree_bfs_index.md\":\"074e0b18\",\"algorithm_linked-list_flip-linked-list_index.md\":\"6be8b0c9\",\"backend_nest_basic_index.md\":\"5421fc20\",\"backend_nest_config_index.md\":\"9e90d872\",\"backend_nest_decorator_index.md\":\"da396ff4\",\"backend_nest_interceptor_index.md\":\"f278ada7\",\"backend_nest_pipe_index.md\":\"e9814517\",\"framework-source-learning_react_01-jsx_index.md\":\"4b9a1fad\",\"index.md\":\"7b7f3e6e\",\"linux_index.md\":\"6ec56294\",\"projects_plasticine-islands_config-resolver_index.md\":\"ea834409\",\"projects_plasticine-islands_conventional-based-routing_index.md\":\"fcb9f3d8\",\"projects_plasticine-islands_introduction_index.md\":\"11b2cfd3\",\"micro-frontend_index.md\":\"57532cb9\",\"micro-frontend_solutions_index.md\":\"fc5246fb\",\"backend_nest_exception_index.md\":\"a270710f\",\"framework-source-learning_react_03-update_index.md\":\"78ef6c28\",\"framework-source-learning_react_04-mount_index.md\":\"09ae6b93\",\"git_index.md\":\"5cbe81f5\",\"projects_plasticine-islands_mdx_index.md\":\"9490627d\",\"micro-frontend_iframe_index.md\":\"d13859c3\",\"micro-frontend_what-problem-solve_index.md\":\"afa9059f\",\"framework-source-learning_react_02-reconciler-basic_index.md\":\"6d673b4b\"}")</script>
    <script type="module" async src="/assets/app.f289581c.js"></script>
    
  </body>
</html>