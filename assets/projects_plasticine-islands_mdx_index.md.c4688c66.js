import{_ as s,c as n,o as a,a as l}from"./app.448484df.js";const p="/assets/mdåˆæ­¥æ–‡ä»¶è§£ææ•ˆæœ.748384c5.png",o="/assets/é›†æˆremark-gfmçš„æ•ˆæœ.8450bc6f.png",e="/assets/é»˜è®¤æƒ…å†µä¸‹markdownä»£ç å—è¢«è½¬æ¢çš„html.4b9b9936.png",t="/assets/é»˜è®¤æƒ…å†µä¸‹éå†ä»£ç å—å¯¹åº”çš„htmlçš„ast.937087f3.png",c="/assets/éå†æ‰€æœ‰typeä¸ºelementçš„èŠ‚ç‚¹.891b68d8.png",r="/assets/preWrapperæ’ä»¶çš„æœ€ç»ˆæ•ˆæœ.be13395b.png",y="/assets/ä»£ç å—è¯­æ³•é«˜äº®æ’ä»¶æ•ˆæœ.c91178e6.png",f=JSON.parse('{"title":"é›†æˆ MDX è§£æèƒ½åŠ›","description":"","frontmatter":{},"headers":[{"level":2,"title":"å‰è¨€","slug":"å‰è¨€","link":"#å‰è¨€","children":[]},{"level":2,"title":"é›†æˆæ€è·¯ & å¾…é›†æˆçš„åŠŸèƒ½","slug":"é›†æˆæ€è·¯-å¾…é›†æˆçš„åŠŸèƒ½","link":"#é›†æˆæ€è·¯-å¾…é›†æˆçš„åŠŸèƒ½","children":[]},{"level":2,"title":"Vite æ’ä»¶ - mdx","slug":"vite-æ’ä»¶-mdx","link":"#vite-æ’ä»¶-mdx","children":[{"level":3,"title":"gfm","slug":"gfm","link":"#gfm","children":[]},{"level":3,"title":"é”šç‚¹è·³è½¬","slug":"é”šç‚¹è·³è½¬","link":"#é”šç‚¹è·³è½¬","children":[]},{"level":3,"title":"ä»£ç å—å±•ç¤ºè¯­è¨€","slug":"ä»£ç å—å±•ç¤ºè¯­è¨€","link":"#ä»£ç å—å±•ç¤ºè¯­è¨€","children":[]},{"level":3,"title":"ä»£ç å—è¯­æ³•é«˜äº®","slug":"ä»£ç å—è¯­æ³•é«˜äº®","link":"#ä»£ç å—è¯­æ³•é«˜äº®","children":[]}]}],"relativePath":"projects/plasticine-islands/mdx/index.md","lastUpdated":1690810046000}'),F={name:"projects/plasticine-islands/mdx/index.md"},D=l(`<h1 id="é›†æˆ-mdx-è§£æèƒ½åŠ›" tabindex="-1">é›†æˆ MDX è§£æèƒ½åŠ› <a class="header-anchor" href="#é›†æˆ-mdx-è§£æèƒ½åŠ›" aria-hidden="true">#</a></h1><div class="tip custom-block"><p class="custom-block-title">æœ¬èŠ‚ä»£ç åˆ†æ”¯åœ°å€</p><p><a href="https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx" target="_blank" rel="noreferrer">https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx</a></p></div><h2 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a></h2><p>é¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹ä¸€äº›å‰ç½®çŸ¥è¯†ï¼š</p><ul><li><p>remark: remark æ˜¯ä¸€ä¸ª Markdown å¤„ç†å™¨ï¼Œå®ƒå¯ä»¥å°† Markdown æ ¼å¼çš„æ–‡æœ¬å†…å®¹è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œç„¶åé€šè¿‡æ’ä»¶ç³»ç»Ÿå¯¹ AST è¿›è¡Œä¿®æ”¹æˆ–æ“ä½œï¼Œæœ€ç»ˆè¾“å‡ºç¬¦åˆç”¨æˆ·éœ€æ±‚çš„æ ¼å¼ã€‚é€šè¿‡ remarkï¼Œå¯ä»¥å¯¹ Markdown æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®ã€ä»£ç å—è½¬æ¢ã€è¡¨æ ¼è½¬æ¢ã€é“¾æ¥å¤„ç†ç­‰æ“ä½œã€‚</p></li><li><p>rehype: rehype æ˜¯ä¸€ä¸ª HTML å¤„ç†å™¨ï¼Œå®ƒå¯ä»¥å°† HTML æ ¼å¼çš„æ–‡æœ¬å†…å®¹è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œç„¶åé€šè¿‡æ’ä»¶ç³»ç»Ÿå¯¹ AST è¿›è¡Œä¿®æ”¹æˆ–æ“ä½œï¼Œæœ€ç»ˆè¾“å‡ºç¬¦åˆç”¨æˆ·éœ€æ±‚çš„æ ¼å¼ã€‚é€šè¿‡ rehypeï¼Œå¯ä»¥å¯¹ HTML æ–‡ä»¶è¿›è¡Œè¯­è¨€è½¬æ¢ã€å…ƒç´ è½¬æ¢ã€å±æ€§è½¬æ¢ã€æ ‡å‡†åŒ–å¤„ç†ç­‰æ“ä½œã€‚</p></li></ul><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œremark ä¸ rehype ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥å®ç° Markdown åˆ° HTML çš„å®Œæ•´è½¬æ¢è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ remark å°† Markdown æ–‡ä»¶è½¬æ¢ä¸º HTMLï¼Œç„¶åä½¿ç”¨ rehype å¯¹ HTML è¿›è¡Œè¿›ä¸€æ­¥çš„ä¿®æ”¹å’Œå¤„ç†ï¼Œä¾‹å¦‚æ·»åŠ æ ·å¼ã€JavaScriptã€SEO ä¼˜åŒ–ç­‰æ“ä½œã€‚</p><p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ remark å¤„ç† markdownï¼Œé›†æˆå„ç§å¤„ç† markdown çš„ remark æ’ä»¶ï¼Œç”Ÿæˆ AST åè½¬æˆ htmlï¼Œå†ä¸¢ç»™ rehype å»å¤„ç†å¦‚æ ·å¼ç­‰åŠŸèƒ½</p><p>ä¸ºäº†æ›´åŠ æ–¹ä¾¿åœ°å®Œæˆè¿™ä»¶äº‹æƒ…ï¼Œåˆå¼•å‡ºäº†ä¸€ä¸ª <code>remark-rehype</code> åº“</p><p>remark-rehype æ˜¯ä¸€ä¸ªåŸºäº remark å’Œ rehype çš„è½¬æ¢å™¨ï¼Œå¯ä»¥å°† Markdown æ ¼å¼çš„æ–‡æœ¬å†…å®¹è½¬æ¢ä¸º HTML æ ¼å¼çš„æ–‡æœ¬å†…å®¹ã€‚å®ƒçš„ä½œç”¨æ˜¯å°† remark ç”Ÿæˆçš„ Markdown æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰è½¬æ¢ä¸º rehype å¯ä»¥å¤„ç†çš„ HTML ASTï¼Œä»è€Œç”Ÿæˆæœ€ç»ˆçš„ HTML è¾“å‡ºã€‚</p><p>remark-rehype çš„ä½œç”¨ç±»ä¼¼äºä¸€ä¸ªæ¡¥æ¢ï¼Œå®ƒå°† remark å’Œ rehype è¿æ¥èµ·æ¥ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨ remark ä¸­ä½¿ç”¨ Markdown è¯­æ³•ï¼Œç„¶åé€šè¿‡ remark-rehype å°†å…¶è½¬æ¢ä¸º rehype å¯ä»¥å¤„ç†çš„ HTML è¯­æ³•ï¼Œæœ€ç»ˆç”Ÿæˆç¬¦åˆç”¨æˆ·éœ€æ±‚çš„ HTML è¾“å‡ºã€‚</p><p>remark-rehype é€šè¿‡æ’ä»¶çš„å½¢å¼æ¥æ‰©å±•å…¶åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ ä¸åŒçš„æ’ä»¶æ¥å®ç°ä¸åŒçš„è½¬æ¢æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ remark-gfm æ’ä»¶æ¥æ”¯æŒ GitHub Flavored Markdown çš„è¯­æ³•ï¼Œç„¶åä½¿ç”¨ rehype-highlight æ’ä»¶æ¥å¯¹ä»£ç å—è¿›è¡Œè¯­æ³•é«˜äº®ï¼Œä»è€Œå®ç°æ›´å¥½çš„ Markdown åˆ° HTML çš„è½¬æ¢æ•ˆæœã€‚</p><h2 id="é›†æˆæ€è·¯-å¾…é›†æˆçš„åŠŸèƒ½" tabindex="-1">é›†æˆæ€è·¯ &amp; å¾…é›†æˆçš„åŠŸèƒ½ <a class="header-anchor" href="#é›†æˆæ€è·¯-å¾…é›†æˆçš„åŠŸèƒ½" aria-hidden="true">#</a></h2><p>å¯ä»¥é€šè¿‡ vite æ’ä»¶çš„æ–¹å¼é›†æˆ mdx çš„è§£æèƒ½åŠ›ï¼Œ<a href="https://mdxjs.com/packages/rollup/" target="_blank" rel="noreferrer">@mdx-js/rollup</a> è¿™ä¸€ rollup æ’ä»¶å°±æä¾›äº†è¿™æ ·çš„èƒ½åŠ›ï¼Œå¥½åœ¨ vite å¯¹ rollup æ’ä»¶çš„å…¼å®¹æ€§å¾ˆå¥½ï¼Œå¯ä»¥æ— ç¼ä½¿ç”¨</p><p><code>@mdx-js/rollup</code> ä¸­æ”¯æŒå•ç‹¬é…ç½® remark å’Œ rehype æ’ä»¶ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªåŒ…æ¥ç»´æŠ¤ mdx ç›¸å…³çš„å„ç§æ’ä»¶é›†æˆ</p><p>é›†æˆçš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li><p><a href="https://github.github.com/gfm/" target="_blank" rel="noreferrer">gfm</a>ï¼šGithub Flavored Markdownï¼Œæ˜¯ä¸€ç§ markdown è§„èŒƒ</p></li><li><p>é”šç‚¹è·³è½¬ï¼šå¯¹äº markdown ä¸­çš„ <code>#</code>ã€<code>##</code> ç­‰æ ‡é¢˜ï¼Œå¤„ç†æˆ html åä¼šè‡ªåŠ¨åŠ ä¸Šé”šç‚¹ï¼Œæ–¹ä¾¿ç‚¹å‡»è¿›è¡Œè·³è½¬</p></li><li><p>ä»£ç å—å±•ç¤ºè¯­è¨€ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼Œèƒ½åœ¨å³ä¾§çœ‹åˆ°ä»£ç å—çš„è¯­è¨€</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello world</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></li><li><p>ä»£ç å—è¯­æ³•é«˜äº®</p></li></ul><h2 id="vite-æ’ä»¶-mdx" tabindex="-1">Vite æ’ä»¶ - mdx <a class="header-anchor" href="#vite-æ’ä»¶-mdx" aria-hidden="true">#</a></h2><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„åŒ… - <code>vite-plugin-mdx</code></p><p>åœ¨å…¥å£æ–‡ä»¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼Œå¹¶é›†æˆåˆ° core åŒ…ä¸­ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-t8CZG" id="tab-zC2rp90" checked="checked"><label for="tab-zC2rp90">packages/vite-plugin-mdx/src/index.ts</label><input type="radio" name="group-t8CZG" id="tab-s4_AanG"><label for="tab-s4_AanG">packages/core/src/helpers/resolve-vite-plugins.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rollupPluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@mdx-js/rollup</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginReact </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@vitejs/plugin-react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">PluginOption</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ResolvedConfig</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">VitePluginPlasticineIslandsSiteConfigOptions</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/types</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginPlasticineIslandsConventionalBasedRouting </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-conventional-based-routing</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginDevServerHtml </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-dev-server-html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line highlighted"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-mdx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> vitePluginPlasticineIslandsSiteConfig </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@plasticine-islands/vite-plugin-plasticine-islands-site-config</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">BUNDLESS_PATH</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">CLIENT_ENTRY_PATH</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">DEV_SERVER_HTML_PATH</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../constants</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ResolveVitePluginsOptions</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">resolvedConfig</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ResolvedConfig</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">onDevServerRestart</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">VitePluginPlasticineIslandsSiteConfigOptions</span><span style="color:#A6ACCD;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">onDevServerRestart</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">resolveVitePlugins</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">options</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ResolveVitePluginsOptions</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginOption</span><span style="color:#A6ACCD;">[] </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">resolvedConfig</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">onDevServerRestart</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">options</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">resolvedConfig</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// react</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginReact</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// dev server</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginDevServerHtml</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      htmlPath</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">DEV_SERVER_HTML_PATH</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      clintEntryPath</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">CLIENT_ENTRY_PATH</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      loadDefaultHtmlOnError</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      filesToWatch</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#A6ACCD;">BUNDLESS_PATH</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// é€šè¿‡è™šæ‹Ÿæ¨¡å—è®©å‰ç«¯åº”ç”¨ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ SiteConfig æ•°æ®</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginPlasticineIslandsSiteConfig</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">resolvedConfig</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">onDevServerRestart</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// çº¦å®šå¼è·¯ç”±</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginPlasticineIslandsConventionalBasedRouting</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// mdx</span></span>
<span class="line highlighted"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>ç„¶åæ¥ playground ä¸­éªŒè¯ä¸€ä¸‹ï¼Œæ–°å»º <code>docs/test.md</code></p><p>å¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><div class="language-md"><button title="Copy Code" class="copy"></button><span class="lang">md</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;"># </span><span style="color:#FFCB6B;">Test markdown</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">## </span><span style="color:#FFCB6B;">Hello</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> foo</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> bar</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> baz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">1.</span><span style="color:#A6ACCD;"> hi</span></span>
<span class="line"><span style="color:#89DDFF;">2.</span><span style="color:#A6ACCD;"> hello</span></span>
<span class="line"><span style="color:#89DDFF;">3.</span><span style="color:#A6ACCD;"> how are u</span></span>
<span class="line"></span></code></pre></div><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="`+p+`" alt="mdåˆæ­¥æ–‡ä»¶è§£ææ•ˆæœ" data-fancybox="gallery"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»èƒ½å¤ŸæˆåŠŸè§£æ md æ–‡ä»¶äº†ï¼Œæ¥ä¸‹æ¥å°±ä¸€æ­¥æ­¥é›†æˆå„ç§å®ç”¨çš„ remark å’Œ rehype æ’ä»¶å§</p><h3 id="gfm" tabindex="-1">gfm <a class="header-anchor" href="#gfm" aria-hidden="true">#</a></h3><p>gfm æ˜¯ä¸€ä¸ª markdown è§„èŒƒï¼Œæ‰€ä»¥ç†æ‰€å½“ç„¶æ˜¯å±äº remark çš„ç®¡è¾–èŒƒç•´ï¼Œå› æ­¤éœ€è¦å…ˆå®‰è£…è¯¥ remark æ’ä»¶</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages/vite-plugin-mdx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remark-gfm</span></span>
<span class="line"></span></code></pre></div><p>ç„¶åé›†æˆåˆ° remark ä¸­</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-nrNtb" id="tab-8mKJq0Z" checked="checked"><label for="tab-8mKJq0Z">packages/vite-plugin-mdx/src/index.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rollupPluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@mdx-js/rollup</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkPluginGFM </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-gfm</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#A6ACCD;">remarkPluginGFM</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>æ¥ä¸‹æ¥ä¿®æ”¹ playground ä¸­åˆšåˆšæ–°å»ºçš„ <code>test.md</code>ï¼Œè¾“å…¥ä¸€äº›é“¾æ¥ï¼Œæ ¹æ® gfm çš„è§„èŒƒï¼Œä¼šè‡ªåŠ¨å°†é“¾æ¥è§£ææˆ a æ ‡ç­¾</p><div class="language-md"><button title="Copy Code" class="copy"></button><span class="lang">md</span><pre class="shiki material-palenight has-diff"><code><span class="line"><span style="color:#89DDFF;"># </span><span style="color:#FFCB6B;">Test markdown</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">## </span><span style="color:#FFCB6B;">Hello</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> foo</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> bar</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> baz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">1.</span><span style="color:#A6ACCD;"> hi</span></span>
<span class="line"><span style="color:#89DDFF;">2.</span><span style="color:#A6ACCD;"> hello</span></span>
<span class="line"><span style="color:#89DDFF;">3.</span><span style="color:#A6ACCD;"> how are u</span></span>
<span class="line"></span>
<span class="line diff add"><span style="color:#A6ACCD;">literals www.example.com, https://example.com and contact@example.com </span></span>
<span class="line"></span></code></pre></div><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="`+o+`" alt="é›†æˆremark-gfmçš„æ•ˆæœ" data-fancybox="gallery"></p><h3 id="é”šç‚¹è·³è½¬" tabindex="-1">é”šç‚¹è·³è½¬ <a class="header-anchor" href="#é”šç‚¹è·³è½¬" aria-hidden="true">#</a></h3><p>è¿™ä¸ªåŠŸèƒ½æ¶‰åŠåˆ°çš„éƒ½æ˜¯å¯¹ html çš„å¤„ç†ï¼Œå› æ­¤å’Œ rehype æœ‰å…³ï¼Œé€šè¿‡åœ¨ github ä¸Šæœç´¢ç›¸å…³æ’ä»¶ï¼Œå¯ä»¥æ‰¾åˆ°ä¸‹é¢ä¸¤ä¸ªæ’ä»¶æ­é…ä½¿ç”¨å¯ä»¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š</p><ul><li><a href="https://github.com/rehypejs/rehype-autolink-headings" target="_blank" rel="noreferrer">rehype-autolink-headings</a>ï¼šç”¨äºä¸ºå¸¦æœ‰ id çš„ <code>h1, h2</code> ç­‰ headings æ ‡ç­¾æ·»åŠ  a æ ‡ç­¾é“¾æ¥ï¼Œå¹¶ä¸” href ä¼šæŒ‡å‘å¯¹åº”çš„ heading æ ‡ç­¾ä¸Šçš„ id</li></ul><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å‰ --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">some-id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">some-id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">aria-hidden</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">tabindex</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#some-id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">icon icon-link</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>é—®é¢˜æ˜¯ç»è¿‡ remark å¤„ç†å¾—åˆ°çš„ ast è¢« rehype è½¬æˆçš„ html ä¸­ï¼Œheadings æ ‡ç­¾æ˜¯æ²¡æœ‰ id å±æ€§çš„ï¼Œå› è€Œæ— æ³•ç”Ÿæˆé”šç‚¹é“¾æ¥ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>è¿™æ—¶å€™å°±éœ€è¦å¦ä¸€ä¸ªæ’ä»¶äº†</p><ul><li><a href="https://github.com/rehypejs/rehype-slug" target="_blank" rel="noreferrer">rehype-slug</a>ï¼šç”¨äºä¸º headings æ ‡ç­¾æ·»åŠ  id å±æ€§</li></ul><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å‰ --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> bar </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- å¤„ç†å --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lorem-ipsum</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Lorem ipsum</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo-</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo ğŸ˜ª</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-------bar---</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> bar </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>ç”Ÿæˆçš„ id ä¼šæ ¹æ®æ ‡ç­¾çš„å†…å®¹æ¥å†³å®š</p><p>è¿™ä¸¤ä¸ªæ’ä»¶æ­é…èµ·æ¥å°±èƒ½å¤Ÿå®ç°é”šç‚¹é“¾æ¥å•¦ï¼</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-HQbLn" id="tab-0sWEVlC" checked="checked"><label for="tab-0sWEVlC">packages/vite-plugin-mdx/src/index.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rollupPluginMdx </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@mdx-js/rollup</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeAutolinkHeadings</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Options</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">RehypeAutolinkHeadingsOptions</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-autolink-headings</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeSlug </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-slug</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkGfm </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-gfm</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// Github Flavored Markdown Spec: https://github.github.com/gfm/</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">remarkGfm</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸º h1, h2 ç­‰ headings æ ‡ç­¾ç”Ÿæˆ idï¼Œid çš„å€¼ä¼šæ ¹æ®æ ‡ç­¾çš„å†…å®¹å†³å®š</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">rehypeSlug</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸ºå¸¦æœ‰ id å±æ€§çš„ headings æ ‡ç­¾æ·»åŠ é”šç‚¹é“¾æ¥</span></span>
<span class="line"><span style="color:#F07178;">      [</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">rehypeAutolinkHeadings</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¸º headings æ ‡ç­¾æ³¨å…¥é¢å¤–çš„ class - ç”¨äºå®šåˆ¶æ ·å¼</span></span>
<span class="line"><span style="color:#F07178;">          properties</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            class</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">header-anchor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">          content</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            value</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RehypeAutolinkHeadingsOptions</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><h3 id="ä»£ç å—å±•ç¤ºè¯­è¨€" tabindex="-1">ä»£ç å—å±•ç¤ºè¯­è¨€ <a class="header-anchor" href="#ä»£ç å—å±•ç¤ºè¯­è¨€" aria-hidden="true">#</a></h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç›®å‰ä½¿ç”¨ä»£ç å—çš„è¯ä¼šè¢«è½¬æˆä»€ä¹ˆæ ·çš„ html</p><p><img src="`+e+`" alt="é»˜è®¤æƒ…å†µä¸‹markdownä»£ç å—è¢«è½¬æ¢çš„html" data-fancybox="gallery"></p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">language-ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>è¿™ç§ç»“æ„çš„ html å¹¶ä¸èƒ½å±•ç¤ºä»£ç å—çš„è¯­è¨€ï¼Œåº”å½“è½¬æˆå¦‚ä¸‹ç»“æ„æ‰è¡Œï¼š</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">language-ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lang</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">js</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">language-ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">code</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">pre</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>è¿™æ ·æ‰æ–¹ä¾¿æˆ‘ä»¬åç»­å»å®ç°æ ·å¼çš„æ—¶å€™è¿›è¡Œå¸ƒå±€ï¼Œé‚£ä¹ˆè¦å¦‚ä½•å®Œæˆè¿™ä¸ªè½¬æ¢å‘¢ï¼Ÿ</p><p>ç”±äºè¿™æ˜¯ä¸€ä¸ªå¯¹ html çš„æ“ä½œï¼Œå› æ­¤é€‚åˆé€šè¿‡ rehype æ’ä»¶å»æ‹¦æˆªè¿›è¡Œè½¬æ¢</p><h4 id="rehype-æ’ä»¶è½¬æ¢ä»£ç å—ç”Ÿæˆçš„-html-ç»“æ„" tabindex="-1">rehype æ’ä»¶è½¬æ¢ä»£ç å—ç”Ÿæˆçš„ html ç»“æ„ <a class="header-anchor" href="#rehype-æ’ä»¶è½¬æ¢ä»£ç å—ç”Ÿæˆçš„-html-ç»“æ„" aria-hidden="true">#</a></h4><p>å¦‚ä½•å¼€å‘ rehype æ’ä»¶å‘¢ï¼Ÿå¯ä»¥åˆ°å…¶ <a href="https://github.com/rehypejs/rehype" target="_blank" rel="noreferrer">å®˜æ–¹æ–‡æ¡£</a> ä¸­æŸ¥çœ‹</p><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä¸‹é¢å‡ ä¸ªåŒ…</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages/vite-plugin-mdx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">unified</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">unist-util-visit</span></span>
<span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">packages/vite-plugin-mdx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@types/hast</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-D</span></span>
<span class="line"></span></code></pre></div><ul><li>unified ç”¨äºæä¾›æ’ä»¶çš„ç±»å‹å®šä¹‰</li><li>unist-util-visit ç”¨äºéå† ast</li><li>@types/hast åˆ™ç”¨äºæä¾› rehype çš„ ast èŠ‚ç‚¹çš„ç±»å‹å®šä¹‰</li></ul><p>æˆ‘ä»¬å¯ä»¥å…ˆç¼–å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•ï¼Œçœ‹çœ‹ç›®å‰éå† rehype çš„ ast æ—¶æ˜¯å•¥æ ·çš„</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-14RU1" id="tab-WRiMtM8" checked="checked"><label for="tab-WRiMtM8">packages/vite-plugin-mdx/src/__test__/rehype-pre-wrapper.test.ts</label><input type="radio" name="group-14RU1" id="tab-Nn5sgIs"><label for="tab-Nn5sgIs">packages/vite-plugin-mdx/src/plugins/rehype-pre-wrapper.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">unified</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkParse </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-parse</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkRehype </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-rehype</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeFormat </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-format</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeStringify </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-stringify</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../plugins</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypePreWrapper</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">happy path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">unified</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkParse</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkRehype</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeFormat</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeStringify</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">\\\`\\\`\\\`</span><span style="color:#C3E88D;">ts</span></span>
<span class="line"><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">\\\`\\\`\\\`</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">processSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;pre&gt;&lt;code class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;language-ts</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;/code&gt;&lt;/pre&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">visit</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unist-util-visit</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ä¸º markdown ä»£ç å—è½¬æ¢æˆçš„ html ä¸­çš„ pre æ ‡ç­¾è¿›è¡Œä¿®æ”¹</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">example</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * before:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * after:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;div class=&quot;language-ts&quot;&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;span class=&quot;lang&quot;&gt;js&lt;/span&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *     &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/div&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rehypePreWrapper</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Root</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">tree</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">visit</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">tree</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 1. æ‰¾åˆ° pre å…ƒç´ èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 2. è§£æå‡ºä»£ç å—çš„è¯­è¨€ç±»å‹</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 3. ä¿®æ”¹ pre å…ƒç´ èŠ‚ç‚¹çš„ç»“æ„</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><p><img src="`+t+`" alt="é»˜è®¤æƒ…å†µä¸‹éå†ä»£ç å—å¯¹åº”çš„htmlçš„ast" data-fancybox="gallery"></p><p>æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è¦æ‰¾åˆ° type ä¸º <code>element</code> ä¸” <code>tagName</code> ä¸º <code>pre</code>ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ type ä¸º <code>element</code>ï¼Œ<code>tagName</code> ä¸º <code>code</code>ï¼Œç„¶åå¯¹å…¶è¿›è¡Œä¿®æ”¹å³å¯</p><p>å¦‚ä½•éå†æ‰€æœ‰çš„ type ä¸º <code>element</code> çš„èŠ‚ç‚¹å‘¢ï¼Ÿ<code>visit</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å°±å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">visit</span><span style="color:#A6ACCD;">(tree</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><img src="`+c+`" alt="éå†æ‰€æœ‰typeä¸ºelementçš„èŠ‚ç‚¹" data-fancybox="gallery"></p><p>æœ€ç»ˆå¯ä»¥å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Element</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">visit</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unist-util-visit</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * ä¸º markdown ä»£ç å—è½¬æ¢æˆçš„ html ä¸­çš„ pre æ ‡ç­¾è¿›è¡Œä¿®æ”¹</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">example</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * before:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * after:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;div class=&quot;language-ts&quot;&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;span class=&quot;lang&quot;&gt;js&lt;/span&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *     &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *   &lt;/pre&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;/div&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rehypePreWrapper</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Root</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">tree</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">visit</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">tree</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 1. æ‰¾åˆ° pre å…ƒç´ èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">visited</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 2. è§£æå‡ºä»£ç å—çš„è¯­è¨€ç±»å‹</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">className</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">toString</span><span style="color:#F07178;">() </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">-</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 3. ä¿®æ”¹ pre å…ƒç´ èŠ‚ç‚¹çš„ç»“æ„ - å…ˆæ‹·è´ä¸€ä¸ª node å‡ºæ¥ï¼Œå†å¯¹ node è¿›è¡Œä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">clonedNode</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          tagName</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pre</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          children</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// é¿å…é‡å¤éå†ç›¸åŒçš„ pre å…ƒç´ èŠ‚ç‚¹å¯¼è‡´é€’å½’æ— æ³•ç»ˆæ­¢</span></span>
<span class="line"><span style="color:#F07178;">            visited</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">div</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">className</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            tagName</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">span</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            properties</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">              className</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lang</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">            children</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#F07178;">                  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">                    type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">                    value</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">                  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">                ]</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#A6ACCD;">clonedNode</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        ]</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/** </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">description</span><span style="color:#676E95;font-style:italic;"> åˆ¤æ–­å…ƒç´ èŠ‚ç‚¹æ˜¯å¦æ˜¯ markdown ä»£ç å—è½¬æ¢è€Œæ¥çš„ html ast èŠ‚ç‚¹ */</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">element</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pre</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">code</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypePreWrapper</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">should wrap the \`pre\` element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">unified</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkParse</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkRehype</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeFormat</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeStringify</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">\\\`\\\`\\\`</span><span style="color:#C3E88D;">ts</span></span>
<span class="line"><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">\\\`\\\`\\\`</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">processSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">      &lt;div class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;language-ts</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;lang</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;ts&lt;/span&gt;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">        &lt;pre&gt;&lt;code class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;language-ts</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;&lt;/pre&gt;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">      &lt;/div&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>æœ€ç»ˆåº”ç”¨åˆ°æ¡†æ¶ä¸­çš„æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="`+r+`" alt="preWrapperæ’ä»¶çš„æœ€ç»ˆæ•ˆæœ" data-fancybox="gallery"></p><h3 id="ä»£ç å—è¯­æ³•é«˜äº®" tabindex="-1">ä»£ç å—è¯­æ³•é«˜äº® <a class="header-anchor" href="#ä»£ç å—è¯­æ³•é«˜äº®" aria-hidden="true">#</a></h3><p>ç›®å‰çš„ä»£ç å—æ¸²æŸ“æ•ˆæœæ˜¯ä¸Šå›¾é‚£æ ·çš„ï¼Œå¹¶æ²¡æœ‰è¯­æ³•é«˜äº®ï¼Œçœ‹èµ·æ¥å¾ˆä¸ç¾è§‚ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±é€šè¿‡ <a href="https://github.com/shikijs/shiki" target="_blank" rel="noreferrer">shiki</a> æ¥å®ç°ä»£ç å—è¯­æ³•é«˜äº®çš„æ•ˆæœ</p><h4 id="ä½“éªŒ-shiki" tabindex="-1">ä½“éªŒ shiki <a class="header-anchor" href="#ä½“éªŒ-shiki" aria-hidden="true">#</a></h4><p>å…ˆé€šè¿‡ä¸€ä¸ªå•æµ‹æ¥ç®€å•åœ°ä½“éªŒä¸€ä¸‹ shiki çš„åŠŸèƒ½</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-vvcLE" id="tab-NL98Vyh" checked="checked"><label for="tab-NL98Vyh">packages/vite-plugin-mdx/src/__test__/rehype-shiki.test.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> shiki </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypeShiki</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki demo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shiki</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHighlighter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      theme</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nord</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">codeToHtml</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> lang</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&quot;&lt;pre class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;shiki nord</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot; style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;background-color: #2e3440ff</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot; tabindex=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;0</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;code&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;console&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;.&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #88C0D0</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;log&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;(&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #A3BE8C</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;hello world&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div></div><h4 id="rehype-æ’ä»¶å®ç°ä»£ç å—è¯­æ³•é«˜äº®" tabindex="-1">rehype æ’ä»¶å®ç°ä»£ç å—è¯­æ³•é«˜äº® <a class="header-anchor" href="#rehype-æ’ä»¶å®ç°ä»£ç å—è¯­æ³•é«˜äº®" aria-hidden="true">#</a></h4><p>æˆ‘ä»¬å¯ä»¥å°† highlighter ä½œä¸ºå‚æ•°ï¼Œè¿™æ ·å°±èƒ½å°†ä»£ç é«˜äº®çš„è‡ªå®šä¹‰èƒ½åŠ›äº¤ç»™å¤–éƒ¨å†³å®šï¼Œæ’ä»¶å†…éƒ¨åªå…³æ³¨ highlighter çš„ä»£ç è½¬æ¢èƒ½åŠ›</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-3fDGs" id="tab-Ul3PO6B" checked="checked"><label for="tab-Ul3PO6B">packages/vite-plugin-mdx/src/plugins/rehype-shiki.ts</label><input type="radio" name="group-3fDGs" id="tab-OQyXsLY"><label for="tab-OQyXsLY">packages/vite-plugin-mdx/src/plugins/shared.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Element</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Highlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Plugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">visit</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unist-util-visit</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fromHtml</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast-util-from-html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">isCodeElement</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parseCodeElement</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./shared</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RehypeShikiOptions</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">shikiHighlighter</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Highlighter</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rehypeShiki</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">[</span><span style="color:#FFCB6B;">RehypeShikiOptions</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Root</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">options</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">options</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">tree</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">visit</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">tree</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">index</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">parent</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">index</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">node</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeContent</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">parseCodeElement</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">codeElement</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlightedCode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">codeToHtml</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">codeContent</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> lang</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// å°† shiki ç”Ÿæˆçš„ html è½¬æˆ hast æ›¿æ¢å½“å‰ node</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fragmentHast</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">fromHtml</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">highlightedCode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> fragment</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#A6ACCD;">parent</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">splice</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">index</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">fragmentHast</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Element</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Text</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hast</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/** </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">description</span><span style="color:#676E95;font-style:italic;"> åˆ¤æ–­å…ƒç´ èŠ‚ç‚¹æ˜¯å¦æ˜¯ markdown ä»£ç å—è½¬æ¢è€Œæ¥çš„ html ast èŠ‚ç‚¹ */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">isCodeElement</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">element</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pre</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">element</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">firstChild</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tagName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">code</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">description</span><span style="color:#676E95;font-style:italic;"> è§£æå‡ºä»£ç å— html å…ƒç´ çš„ classNameã€ä»£ç å†…å®¹ã€ä»£ç è¯­è¨€ç±»å‹</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">example</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * &lt;code class=&quot;language-ts&quot;&gt;console.log(&#39;hello world&#39;)&lt;/code&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * \`\`\`</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">parseCodeElement</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">codeElement</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeContent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">codeElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Text</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">className</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">toString</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">-</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">at</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">codeElementClassName</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">codeContent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">codeLanguageType</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>æœ€åæ•ˆæœå¦‚ä¸‹ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-ldeeQ" id="tab-u_Yawi3" checked="checked"><label for="tab-u_Yawi3">packages/vite-plugin-mdx/src/__test__/rehype-shiki.test.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeFormat </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-format</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> rehypeStringify </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehype-stringify</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkParse </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-parse</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> remarkRehype </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">remark-rehype</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> shiki </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">unified</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unified</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rehypeShiki</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../plugins</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rehypeShiki</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shiki demo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shiki</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHighlighter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      theme</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nord</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">highlighter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">codeToHtml</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> lang</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&quot;&lt;pre class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;shiki nord</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot; style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;background-color: #2e3440ff</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot; tabindex=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;0</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;code&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;console&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;.&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #88C0D0</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;log&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;(&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #A3BE8C</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;hello world&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">should highlight the code</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shiki</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHighlighter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      theme</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nord</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">unified</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkParse</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">remarkRehype</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeShiki</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">shikiHighlighter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeFormat</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">rehypeStringify</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">\\\`\\\`\\\`</span><span style="color:#C3E88D;">ts</span></span>
<span class="line"><span style="color:#C3E88D;">console.log(&#39;hello world&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">\\\`\\\`\\\`</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">processor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">processSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">markdown</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchInlineSnapshot</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;pre class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;shiki nord</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot; style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;background-color: #2e3440ff</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot; tabindex=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;0</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;code&gt;&lt;span class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;console&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;.&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #88C0D0</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;log&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;(&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #A3BE8C</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;hello world&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #ECEFF4</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&#39;&lt;/span&gt;&lt;span style=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;color: #D8DEE9FF</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;)&lt;/span&gt;&lt;/span&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;span class=</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;line</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div></div><p>æœ€åæ•´åˆåˆ° Vite æ’ä»¶ä¸­å³å¯</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-Hrcly" id="tab-ZQHq4Z3" checked="checked"><label for="tab-ZQHq4Z3">packages/vite-plugin-mdx/src/index.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vitePluginMdx</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">rollupPluginMdx</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    remarkPlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// Github Flavored Markdown Spec: https://github.github.com/gfm/</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">remarkGfm</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    rehypePlugins</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸º h1, h2 ç­‰ headings æ ‡ç­¾ç”Ÿæˆ idï¼Œid çš„å€¼ä¼šæ ¹æ®æ ‡ç­¾çš„å†…å®¹å†³å®š</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">rehypeSlug</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨ä¸ºå¸¦æœ‰ id å±æ€§çš„ headings æ ‡ç­¾æ·»åŠ é”šç‚¹é“¾æ¥</span></span>
<span class="line"><span style="color:#F07178;">      [</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">rehypeAutolinkHeadings</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¸º headings æ ‡ç­¾æ³¨å…¥é¢å¤–çš„ class - ç”¨äºå®šåˆ¶æ ·å¼</span></span>
<span class="line"><span style="color:#F07178;">          properties</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            class</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">header-anchor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">          content</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            value</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RehypeAutolinkHeadingsOptions</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å°† markdown ä»£ç å—è½¬æ¢æˆçš„ html pre å…ƒç´ èŠ‚ç‚¹ wrap åˆ° div é‡Œï¼Œå¹¶å¸¦ä¸Šä»£ç å—å¯¹åº”çš„è¯­è¨€</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">rehypePreWrapper</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ä»£ç å—è¯­æ³•é«˜äº®</span></span>
<span class="line highlighted"><span style="color:#F07178;">      [</span></span>
<span class="line highlighted"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">rehypeShiki</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">          shikiHighlighter</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">getShikiHighlighter</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RehypeShikiOptions</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#F07178;">      ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div></div><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹</p><p><img src="`+y+'" alt="ä»£ç å—è¯­æ³•é«˜äº®æ’ä»¶æ•ˆæœ" data-fancybox="gallery"></p><div class="tip custom-block"><p class="custom-block-title">æœ¬èŠ‚ä»£ç åˆ†æ”¯åœ°å€</p><p><a href="https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx" target="_blank" rel="noreferrer">https://github.com/Plasticine-Yang/plasticine-islands/tree/feat/mdx</a></p></div>',88),i=[D];function C(A,d,g,h,u,E){return a(),n("div",null,i)}const v=s(F,[["render",C]]);export{f as __pageData,v as default};
