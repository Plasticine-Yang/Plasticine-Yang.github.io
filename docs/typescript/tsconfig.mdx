import { Tab, Tabs } from 'rspress/theme'

# tsconfig

## 简介

`tsconfig.json` 中的配置项超过 100 项，每个逐个看不利于理解和记忆，但官方将这些配置项分为四个大类：

- `root fields`: 让 TypeScript 知道要处理哪些文件
- `compilerOptions`: 编译相关的配置项，也是日常开发中最常接触的
- `watchOptions`: watch mode 相关配置项
- `typeAcquisition`: 用于调整类型添加到 JavaScript 项目的方式

本文会梳理一些我日常开发中经常用到的配置项的功能。

## root fields

### extends

用于继承已有的 `tsconfig.json` 文件中的配置，路径解析算法与 Node.js 的标准一致，这意味着既可以使用相对路径也可以直接使用 npm 包名的方式，使用 npm 包的时候默认会消费包内的 `tsconfig.json`，当有多个配置文件时也可以手动指定。

<Tabs>
  <Tab label="packages/shared">

```shell
shared
├── package.json
└── tsconfig.json
```

  </Tab>

  <Tab label="packages/foo/tsconfig.json">

```json
{
  // "extends": ["shared"]
  "extends": ["shared/tsconfig.json"]
}
```

  </Tab>
</Tabs>

## compilerOptions

### interop 相关

在编译领域，interop 指的是不同语言、系统或平台之间进行交互和通信的能力。它强调的是在不同编程语言、框架或环境之间无缝地传递数据、调用函数或共享资源的能力。

#### esModuleInterop

不开启时：

- `import * as moment from "moment"` 等价于 `const moment = require("moment")`
- `import moment from "moment"` 等价于 `const moment = require("moment").default`

下面以一个例子演示：

```ts
import * as fs from 'fs'

fs.readFileSync('file.txt', 'utf8')
```

不开启时的编译结果：

```js
'use strict'
Object.defineProperty(exports, '__esModule', { value: true })
var fs = require('fs')
fs.readFileSync('file.txt', 'utf8')
```

开启后的编译结果：

```js
'use strict'
var __createBinding =
  (this && this.__createBinding) ||
  (Object.create
    ? function (o, m, k, k2) {
        if (k2 === undefined) k2 = k
        var desc = Object.getOwnPropertyDescriptor(m, k)
        if (!desc || ('get' in desc ? !m.__esModule : desc.writable || desc.configurable)) {
          desc = {
            enumerable: true,
            get: function () {
              return m[k]
            },
          }
        }
        Object.defineProperty(o, k2, desc)
      }
    : function (o, m, k, k2) {
        if (k2 === undefined) k2 = k
        o[k2] = m[k]
      })
var __setModuleDefault =
  (this && this.__setModuleDefault) ||
  (Object.create
    ? function (o, v) {
        Object.defineProperty(o, 'default', { enumerable: true, value: v })
      }
    : function (o, v) {
        o['default'] = v
      })
var __importStar =
  (this && this.__importStar) ||
  function (mod) {
    if (mod && mod.__esModule) return mod
    var result = {}
    if (mod != null)
      for (var k in mod)
        if (k !== 'default' && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k)
    __setModuleDefault(result, mod)
    return result
  }
Object.defineProperty(exports, '__esModule', { value: true })
var fs = __importStar(require('fs'))
fs.readFileSync('file.txt', 'utf8')
```

也就是会注入一些运行时代码抹平 esm 和 cjs 之间的差异
